var rogueLikeLike;rogueLikeLike=angular.module("rogueLikeLike",[]),Crafty.c("Grid",{init:function(){this.attr({w:Game.grid.tile.width,h:Game.grid.tile.height})},at:function(t,e){return void 0===t&&void 0===e?{x:this.x/Game.grid.tile.width,y:this.y/Game.grid.tile.height}:(this.attr({x:t*Game.grid.tile.width,y:e*Game.grid.tile.height}),this)}}),Crafty.c("Actor",{init:function(){this.requires("2D, Canvas, Grid")}}),Crafty.c("Tree",{init:function(){this.requires("Actor, Color, Solid").color("rgb(20, 10, 40)")}}),Crafty.c("Bush",{init:function(){this.requires("Actor, Color, Solid").color("rgb(20, 185, 40)")}}),Crafty.c("Agent",{init:function(){this.requires("Actor, Fourway, Color, Collision").fourway(4).stopOnSolids().color("rgb(20, 75, 40)")},stopOnSolids:function(){return this.onHit("Solid",this.stopMovement),this},stopMovement:function(){return this._speed=0,this._movement?(this.x-=this._movement.x,this.y-=this._movement.y):void 0}});var Game;Game={edgeColor:"rgb(20, 125, 40)",tileColor:"rgb(20, 185, 40)",grid:{width:64,height:64,tile:{width:8,height:8}},start:function(){return Crafty.init(512,512),Crafty.background("green"),Game.placeAgent(),Game.generateTiles()},newTile:function(t,e){return{y:Game.grid.tile.height*e,x:Game.grid.tile.width*t,w:Game.grid.tile.width,h:Game.grid.tile.height}},generateTiles:function(){var t,e,i,r,n;for(n=[],t=i=0,r=Game.grid.width;r>=0?r>i:i>r;t=r>=0?++i:--i)n.push(function(){var i,r,n;for(n=[],e=i=0,r=Game.grid.height;r>=0?r>i:i>r;e=r>=0?++i:--i)n.push(Game.atEdge(t,e)?Game.placeEdge(t,e):void 0);return n}());return n},width:function(){return this.grid.width*this.grid.tile.width},height:function(){return this.grid.height*this.grid.tile.height},atEdge:function(t,e){return 0===t||0===e||t===Game.grid.width-1||e===Game.grid.height-1},placeAgent:function(t,e){return t=t||5,e=e||5,console.log("x, y of agent",t,e),Crafty.e("Agent").at(t,e)},placeEdge:function(t,e){return Crafty.e("Tree").at(t,e)},placeBush:function(t,e){return Math.random()<.06?Crafty.e("Bush").at(t,e):void 0},placeTile:function(t,e){return Crafty.e("2D, Canvas, Color").attr(Game.newTile(t,e)).color(Game.tileColor)}},window.addEventListener("load",Game.start);var h,mouseover,svg,translate,w,x,y,z;translate=function(t){return"translate("+t%x*z+","+Math.floor(t/x)*z+")"},mouseover=function(t){this.parentNode.appendChild(this),console.log("d",t,"this",this),d3.select(this).transition().duration(500).style("fill-opacity",0).transition().delay(1e3).style("fill-opacity",100)},w=512,h=512,z=8,x=w/z,y=h/z,svg=d3.select("body").append("svg").attr("width",w).attr("height",h),svg.selectAll("rect").data(d3.range(x*y)).enter().append("rect").attr("transform",translate).attr("width",z).attr("height",z).style("fill",function(){return d3.rgb(55,55,55)}).on("mouseover",mouseover),function(t,e){"use strict";return e.factory("MessageFactory",function(t){var e;return e=function(){function e(e){this.scope=e,this.messages=[],this.ws=new WebSocket("ws://localhost:8080/"),this.setupWebsocketMethods(),t.info("MessageFactory constructed")}return e.prototype.add=function(t){this.scope.$apply(function(e){return function(){e.messages.push(t)}}(this))},e.prototype.setupWebsocketMethods=function(){this.ws.onopen=function(e){return function(){t.info("onopen called","CONNECT"),e.add("CONNECT")}}(this),this.ws.onclose=function(e){return function(){t.info("onclose called","DISCONNECT"),e.add("DISCONNECT")}}(this),this.ws.onmessage=function(e){return function(i){t.info("onmessage called","MESSAGE: "+i.data),e.add("MESSAGE: "+i.data)}}(this),this.ws.onerror=function(e){t.info("WEBSOCKET ERROR",e)}},e}()})}(angular,rogueLikeLike),function(t,e){"use strict";return e.controller("MainController",function(t,e){t.board=e})}(angular,rogueLikeLike),function(t,e){"use strict";return e.controller("MessagesController",function(t,e,i){t.view=new i(t)})}(angular,rogueLikeLike);