Crafty.c("Grid",{init:function(){this.attr({w:Game.grid.tile.width,h:Game.grid.tile.height})},at:function(t,e){return void 0===t&&void 0===e?{x:this.x/Game.grid.tile.width,y:this.y/Game.grid.tile.height}:(this.attr({x:t*Game.grid.tile.width,y:e*Game.grid.tile.height}),this)}}),Crafty.c("Actor",{init:function(){this.requires("2D, Canvas, Grid")}}),Crafty.c("Tree",{init:function(){this.requires("Actor, Color, Solid").color("rgb(20, 10, 40)")}}),Crafty.c("Bush",{init:function(){this.requires("Actor, Color, Solid").color("rgb(20, 185, 40)")}}),Crafty.c("Agent",{init:function(){this.requires("Actor, Fourway, Color, Collision").fourway(4).stopOnSolids().color("rgb(20, 75, 40)").bind("KeyUp",function(t){return function(e){return console.log("keyup",e,{x:t.x,y:t.y})}}(this)).bind("Move",function(){return function(t){return console.log("move:",t)}}(this)),console.log("Agent:",this._movement)},stopOnSolids:function(){return this.onHit("Solid",this.stopMovement),this},stopMovement:function(){return this._speed=0,this._movement?(this.x-=this._movement.x,this.y-=this._movement.y):void 0}});var Game;Game={edgeColor:"rgb(20, 125, 40)",tileColor:"rgb(20, 185, 40)",grid:{width:64,height:64,tile:{width:8,height:8}},start:function(){return Crafty.init(512,512),Crafty.background("green"),Game.placeAgent(),Game.generateTiles()},newTile:function(t,e){return{y:Game.grid.tile.height*e,x:Game.grid.tile.width*t,w:Game.grid.tile.width,h:Game.grid.tile.height}},generateTiles:function(){var t,e,i,n,r,o,s,a,h;for(e=function(){s=[];for(var t=0,e=Game.grid.width;e>=0?e>t:t>e;e>=0?t++:t--)s.push(t);return s}.apply(this),t=function(){a=[];for(var t=0,e=Game.grid.height;e>=0?e>t:t>e;e>=0?t++:t--)a.push(t);return a}.apply(this),h=[],r=0,o=e.length;o>r;r++)i=e[r],h.push(function(){var e,r,o;for(o=[],e=0,r=t.length;r>e;e++)n=t[e],o.push(Game.atEdge(i,n)?Game.placeEdge(i,n):void 0);return o}());return h},width:function(){return this.grid.width*this.grid.tile.width},height:function(){return this.grid.height*this.grid.tile.height},atEdge:function(t,e){return 0===t||0===e||t===Game.grid.width-1||e===Game.grid.height-1},placeAgent:function(t,e){return t=t||5,e=e||5,console.log("x, y of agent",t,e),Crafty.e("Agent").at(t,e)},placeEdge:function(t,e){return Crafty.e("Tree").at(t,e)},placeBush:function(t,e){return Math.random()<.06?Crafty.e("Bush").at(t,e):void 0},placeTile:function(t,e){return Crafty.e("2D, Canvas, Color").attr(Game.newTile(t,e)).color(Game.tileColor)}},window.addEventListener("load",Game.start),Game.io={messages:[],ws:new WebSocket("ws://localhost:8080/")},Game.io.ws.onopen=function(){return function(t){return console.log("closed socket",t),Game.start(),t}}(this),Game.io.ws.onclose=function(){return function(t){return console.log("closed socket",t),t}}(this),Game.io.ws.onmessage=function(){return function(t){return console.log("message on socket",t),t}}(this),Game.io.ws.onerror=function(t){return console.log("WEBSOCKET ERROR",t),t};